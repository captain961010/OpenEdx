"use strict";(globalThis.webpackChunk_edx_frontend_app_course_authoring=globalThis.webpackChunk_edx_frontend_app_course_authoring||[]).push([[370],{38349:(e,a,s)=>{s.d(a,{Z:()=>L});var r=s(56549),t=s(48387),n=s(95381),i=s(34926),o=s(41857),l=s(23768),d=s(4138),u=s(77062),g=s(95765),p=s(40113),m=s(36284),c=s(6871),h=s(2652),f=s.n(h),b=s(89526),x=s(2984),M=s(58417),y=s(29519),v=s(87037),S=s(26672),T=s(72079),j=s(56132),R=s(88146),A=s(58408),z=s(79138),N=s(22423),P=s(72999),E=s(26329),C=s(94488);const Z=(0,s(93477).vU)({cancel:{id:"course-authoring.pages-resources.app-settings-modal.button.cancel",defaultMessage:"Cancel"},save:{id:"course-authoring.pages-resources.app-settings-modal.button.save",defaultMessage:"Save"},saving:{id:"course-authoring.pages-resources.app-settings-modal.button.saving",defaultMessage:"Saving"},saved:{id:"course-authoring.pages-resources.app-settings-modal.button.saved",defaultMessage:"Saved"},retry:{id:"course-authoring.pages-resources.app-settings-modal.button.retry",defaultMessage:"Retry"},enabled:{id:"course-authoring.pages-resources.app-settings-modal.badge.enabled",defaultMessage:"Enabled"},disabled:{id:"course-authoring.pages-resources.app-settings-modal.badge.disabled",defaultMessage:"Disabled"},errorSavingTitle:{id:"course-authoring.pages-resources.app-settings-modal.save-error.title",defaultMessage:"We couldn't apply your changes."},errorSavingMessage:{id:"course-authoring.pages-resources.app-settings-modal.save-error.message",defaultMessage:"Please check your entries and try again."}});var O=s(67557);function q(e,a){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),s.push.apply(s,r)}return s}function k(e){for(var a=1;a<arguments.length;a++){var s=null!=arguments[a]?arguments[a]:{};a%2?q(Object(s),!0).forEach((function(a){F(e,a,s[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):q(Object(s)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))}))}return e}function F(e,a,s){return(a=function(e){var a=function(e,a){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof a?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s,e}const D=e=>{let{formikProps:a,children:s,showForm:r}=e;return s&&(0,O.jsx)(n.Z,{children:r?(0,O.jsx)(b.Fragment,{children:s(a)},"app-enabled"):(0,O.jsx)(b.Fragment,{},"app-disabled")})};D.propTypes={formikProps:f().object.isRequired,showForm:f().bool.isRequired,children:f().func},D.defaultProps={children:null};const w=e=>{let{intl:a,title:s,onClose:r,variant:t,isMobile:n,children:l,footer:d}=e;return(0,O.jsxs)(i.Z,{title:s,isOpen:!0,onClose:r,size:"lg",variant:t,hasCloseButton:n,isFullscreenOnMobile:!0,children:[(0,O.jsx)(i.Z.Header,{children:(0,O.jsx)(i.Z.Title,{"data-testid":"modal-title",children:s})}),(0,O.jsx)(i.Z.Body,{children:l}),(0,O.jsx)(i.Z.Footer,{className:"p-4",children:(0,O.jsxs)(o.Z,{children:[(0,O.jsx)(i.Z.CloseButton,{variant:"tertiary",children:a.formatMessage(Z.cancel)}),d]})})]})};w.propTypes={intl:r.gm.isRequired,title:f().string.isRequired,onClose:f().func.isRequired,variant:f().oneOf(["default","dark"]).isRequired,isMobile:f().bool.isRequired,children:f().node.isRequired,footer:f().node},w.defaultProps={footer:null};const H=e=>{let{intl:a,appId:s,title:r,children:t,configureBeforeEnable:n,initialValues:i,validationSchema:o,onClose:h,onSettingsSave:f,enableAppLabel:q,enableAppHelp:F,learnMoreText:H,enableReinitialize:L,hideAppToggle:_}=e;const{courseId:G}=(0,b.useContext)(C.e),B=(0,x.v9)(z.vc),I=(0,x.v9)(z.Yu),U=(0,b.useRef)(null),[V,X]=(0,b.useState)(!1),$=(0,j.tT)("courseApps",s),Y=(0,x.I0)(),J=I===y.eE.IN_PROGRESS?"pending":"default",W=(0,A.dD)(),K=W?"dark":"default";(0,b.useEffect)((()=>{I===y.eE.SUCCESSFUL&&(Y((0,N.Yn)({status:""})),h())}),[I]);const Q=e=>{let{handleSubmit:a,errors:s}=e;return async e=>{await a(e),Object.keys(s).length>0&&(await X(!0),U?.current.scrollIntoView?.())}},ee=$.documentationLinks?.learnMoreConfiguration&&(0,O.jsx)(l.ZP,{className:"text-primary-500",destination:$.documentationLinks.learnMoreConfiguration,target:"_blank",rel:"noreferrer noopener",children:H});return B===y.eE.SUCCESSFUL?(0,O.jsx)(c.J9,{initialValues:k({enabled:!!$?.enabled},i),validationSchema:M.Ry().shape(k({enabled:M.O7()},o)),onSubmit:async e=>{let a=!0;$.enabled!==e.enabled&&(a=await Y((0,P.JU)(G,$.id,e.enabled))),f&&(a=a&&await f(e)),await X(!a),!a&&U?.current.scrollIntoView()},enableReinitialize:L,children:e=>(0,O.jsx)(d.ZP,{onSubmit:Q(e),children:(0,O.jsxs)(w,{title:r,isOpen:!0,onClose:h,variant:K,isMobile:W,isFullscreenOnMobile:!0,intl:a,footer:(0,O.jsx)(u.Z,{labels:{default:a.formatMessage(Z.save),pending:a.formatMessage(Z.saving),complete:a.formatMessage(Z.saved)},state:J,onClick:Q(e)}),children:[V&&(0,O.jsxs)(g.Z,{variant:"danger",icon:m.Z,ref:U,children:[(0,O.jsx)(g.Z.Heading,{children:e.errors.enabled?.title||a.formatMessage(Z.errorSavingTitle)}),e.errors.enabled?.message||a.formatMessage(Z.errorSavingMessage)]}),!_&&(0,O.jsx)(S.Z,{id:`enable-${s}-toggle`,name:"enabled",onChange:a=>e.handleChange(a),onBlur:e.handleBlur,checked:e.values.enabled,label:(0,O.jsxs)("div",{className:"d-flex align-items-center",children:[q,e.values.enabled&&(0,O.jsx)(p.Z,{className:"ml-2",variant:"success","data-testid":"enable-badge",children:a.formatMessage(Z.enabled)})]}),helpText:(0,O.jsxs)("div",{children:[(0,O.jsx)("p",{children:F}),(0,O.jsx)("span",{className:"py-3",children:ee})]})}),(e.values.enabled||n)&&t&&(0,O.jsx)(E.Z,{marginAdj:{default:0,sm:0}}),(0,O.jsx)(D,{formikProps:e,showForm:e.values.enabled||n,children:t})]})})}):(0,O.jsxs)(w,{intl:a,title:r,isOpen:!0,onClose:h,size:"sm",variant:K,isMobile:W,isFullscreenOnMobile:!0,children:[B===y.eE.IN_PROGRESS&&(0,O.jsx)(T.Z,{}),B===y.eE.FAILED&&(0,O.jsx)(v.Z,{}),B===y.eE.DENIED&&(0,O.jsx)(R.Z,{})]})};H.propTypes={intl:r.gm.isRequired,title:f().string.isRequired,appId:f().string.isRequired,children:f().func,onSettingsSave:f().func,initialValues:f().shape({}),validationSchema:f().shape({}),onClose:f().func.isRequired,enableAppLabel:f().string.isRequired,enableAppHelp:f().string.isRequired,learnMoreText:f().string.isRequired,configureBeforeEnable:f().bool,enableReinitialize:f().bool,hideAppToggle:f().bool},H.defaultProps={children:null,onSettingsSave:null,initialValues:{},validationSchema:{},configureBeforeEnable:!1,enableReinitialize:!1,hideAppToggle:!1};const L=(0,t.Z)(H)},7370:(e,a,s)=>{s.r(a),s.d(a,{default:()=>z});var r=s(56549),t=s(48387),n=s(4138),i=s(25180),o=s(3878),l=s(6871),d=s(2652),u=s.n(d),g=s(89526),p=s(50586),m=s(58417),c=s(29519),h=s(4985),f=s(58408),b=s(38349),x=s(95381),M=s(52425);const y=(0,s(93477).vU)({heading:{id:"authoring.pagesAndResources.teams.heading",defaultMessage:"Configure teams"},enableTeamsLabel:{id:"authoring.pagesAndResources.teams.enableTeams.label",defaultMessage:"Teams"},enableTeamsHelp:{id:"authoring.pagesAndResources.teams.enableTeams.help",defaultMessage:"Allow learners to work together on specific projects or activities."},enableTeamsLink:{id:"authoring.pagesAndResources.teams.enableTeams.link",defaultMessage:"Learn more about teams"},teamSize:{id:"authoring.pagesAndResources.teams.teamSize.heading",defaultMessage:"Team size"},maxTeamSize:{id:"authoring.pagesAndResources.teams.teamSize.maxTeamSize",defaultMessage:"Max team size"},maxTeamSizeHelp:{id:"authoring.pagesAndResources.teams.teamSize.maxTeamSizeHelp",defaultMessage:"The maximum number of learners that can join a team"},maxTeamSizeEmpty:{id:"authoring.pagesAndResources.teams.teamSize.maxTeamSizeEmpty",defaultMessage:"Enter max team size"},maxTeamSizeInvalid:{id:"authoring.pagesAndResources.teams.teamSize.maxTeamSizeInvalid",defaultMessage:"Max team size must be a positive number larger than zero."},maxTeamSizeTooHigh:{id:"authoring.pagesAndResources.teams.teamSize.maxTeamSizeTooHigh",defaultMessage:"Max team size cannot be greater than {max}"},groups:{id:"authoring.pagesAndResources.teams.groups.heading",defaultMessage:"Groups"},groupsHelp:{id:"authoring.pagesAndResources.teams.groups.help",defaultMessage:"Groups are spaces where learners can create or join teams."},configureGroup:{id:"authoring.pagesAndResources.teams.configureGroup.heading",defaultMessage:"Configure group"},groupFormNameLabel:{id:"authoring.pagesAndResources.teams.group.name.label",defaultMessage:"Name"},groupFormNameHelp:{id:"authoring.pagesAndResources.teams.group.name.help",defaultMessage:"Choose a unique name for this group"},groupFormNameEmpty:{id:"authoring.pagesAndResources.teams.group.name.error.empty",defaultMessage:"Enter a unique name for this group"},groupFormNameExists:{id:"authoring.pagesAndResources.teams.group.name.error.exists",defaultMessage:"It looks like this name is already in use"},groupFormDescriptionLabel:{id:"authoring.pagesAndResources.teams.group.description.label",defaultMessage:"Description"},groupFormDescriptionHelp:{id:"authoring.pagesAndResources.teams.group.description.help",defaultMessage:"Enter details about this group"},groupFormDescriptionError:{id:"authoring.pagesAndResources.teams.group.description.error",defaultMessage:"Enter a description for this group"},groupFormTypeLabel:{id:"authoring.pagesAndResources.teams.group.type.label",defaultMessage:"Type"},groupFormTypeHelp:{id:"authoring.pagesAndResources.teams.group.type.help",defaultMessage:"Control who can see, create and join teams"},groupTypeOpen:{id:"authoring.pagesAndResources.teams.group.types.open",defaultMessage:"Open"},groupTypeOpenDescription:{id:"authoring.pagesAndResources.teams.group.types.open.description",defaultMessage:"Learners can create, join, leave, and see other teams"},groupTypePublicManaged:{id:"authoring.pagesAndResources.teams.group.types.public_managed",defaultMessage:"Public managed"},groupTypePublicManagedDescription:{id:"authoring.pagesAndResources.teams.group.types.public_managed.description",defaultMessage:"Only course staff can control teams and memberships. Learners can see other teams."},groupTypePrivateManaged:{id:"authoring.pagesAndResources.teams.group.types.private_managed",defaultMessage:"Private managed"},groupTypePrivateManagedDescription:{id:"authoring.pagesAndResources.teams.group.types.private_managed.description",defaultMessage:"Only course staff can control teams, memberships, and see other teams"},groupFormMaxSizeLabel:{id:"authoring.pagesAndResources.teams.group.maxSize.label",defaultMessage:"Max team size (optional)"},groupFormMaxSizeHelp:{id:"authoring.pagesAndResources.teams.group.maxSize.help",defaultMessage:"Override the global max team size"},addGroup:{id:"authoring.pagesAndResources.teams.addGroup.button",defaultMessage:"Add group"},deleteAlt:{id:"authoring.pagesAndResources.teams.group.delete",defaultMessage:"Delete"},expandAlt:{id:"authoring.pagesAndResources.teams.group.expand",defaultMessage:"Expand group editor"},collapseAlt:{id:"authoring.pagesAndResources.teams.group.collapse",defaultMessage:"Close group editor"},delete:{id:"authoring.pagesAndResources.teams.deleteGroup.initiateDelete",defaultMessage:"Delete"},cancel:{id:"authoring.pagesAndResources.teams.deleteGroup.cancel-delete.button",defaultMessage:"Cancel"},groupDeleteHeading:{id:"authoring.pagesAndResources.teams.deleteGroup.heading",defaultMessage:"Delete this group?"},groupDeleteBody:{id:"authoring.pagesAndResources.teams.deleteGroup.body",defaultMessage:"edX recommends that you do not delete groups once your course is running.\n    Your group will no longer be visible in the LMS and learners will not be able to leave teams associated with it.\n    Please delete learners from teams before deleting the associated group.",description:"Message displayed to admins when deleting a group. Make sure to include line breaks so that the final text is rendered properly."},noGroupsErrorTitle:{id:"authoring.pagesAndResources.teams.enableGroups.error.noGroupsFound.title",defaultMessage:"No groups found",description:"Title of error message displayed when a user tries to enable teams but no group is defined."},noGroupsErrorMessage:{id:"authoring.pagesAndResources.teams.enableGroups.error.noGroupsFound.message",defaultMessage:"Add one or more groups to enable teams.",description:"Body of error message displayed when a user tries to enable teams but no group is defined."}});var v=s(67557);const S={[c.kq.OPEN]:{label:y.groupTypeOpen,description:y.groupTypeOpenDescription},[c.kq.PUBLIC_MANAGED]:{label:y.groupTypePublicManaged,description:y.groupTypePublicManagedDescription},[c.kq.PRIVATE_MANAGED]:{label:y.groupTypePrivateManaged,description:y.groupTypePrivateManagedDescription}},T=e=>{let{intl:a,group:s,onDelete:r,onChange:t,onBlur:o,fieldNameCommonBase:l,errors:d}=e;const[u,p]=(0,g.useState)(!1),[m,f]=(0,g.useState)(null===s.id),b="mb-4 mx-2";return(0,v.jsx)(x.Z,{children:u?(0,v.jsxs)("div",{className:"d-flex flex-column card rounded mb-3 px-4 py-2 p-4",children:[(0,v.jsx)("h4",{className:"mb-3",children:a.formatMessage(y.groupDeleteHeading)}),a.formatMessage(y.groupDeleteBody).split("\n").map((e=>(0,v.jsx)("p",{children:e}))),(0,v.jsxs)("div",{className:"d-flex flex-row justify-content-end",children:[(0,v.jsx)(i.ZP,{variant:"muted",size:"sm",onClick:()=>p(!1),children:a.formatMessage(y.cancel)}),(0,v.jsx)(i.ZP,{variant:"outline-danger",size:"sm",onClick:()=>r(s),children:a.formatMessage(y.delete)})]})]},"isDeleting"):(0,v.jsxs)(M.Z,{open:m,onToggle:e=>f(Boolean(d.name||d.maxTeamSize||d.description)||e),onDelete:()=>p(!0),deleteAlt:a.formatMessage(y.deleteAlt),expandAlt:a.formatMessage(y.expandAlt),collapseAlt:a.formatMessage(y.collapseAlt),title:m?(0,v.jsx)("div",{className:"d-flex flex-column flex-shrink-1 h4 p-0 m-0",children:a.formatMessage(y.configureGroup)}):(0,v.jsxs)("div",{className:"d-flex flex-column flex-shrink-1 small mw-100",children:[(0,v.jsxs)("div",{className:"small text-gray-500",children:[a.formatMessage(S[s.type?s.type:c.kq.OPEN].label)," "]}),(0,v.jsx)("div",{className:"h4 text-truncate my-1 font-weight-normal",children:s.name}),(0,v.jsx)("div",{className:"small text-truncate text-muted text-gray-500",children:s.description})]}),children:[(0,v.jsx)(h.Z,{name:`${l}.name`,value:s.name,floatingLabel:a.formatMessage(y.groupFormNameLabel),help:a.formatMessage(y.groupFormNameHelp),className:`${b} mt-2.5`}),(0,v.jsx)(h.Z,{name:`${l}.description`,value:s.description,floatingLabel:a.formatMessage(y.groupFormDescriptionLabel),help:a.formatMessage(y.groupFormDescriptionHelp),as:"textarea",rows:4,style:{minHeight:"2.5rem"},className:b}),(0,v.jsxs)(n.ZP.Group,{className:b,children:[(0,v.jsx)(n.ZP.Label,{className:"h4 my-3",children:a.formatMessage(y.groupFormTypeLabel)}),(0,v.jsx)(n.ZP.RadioSet,{name:`${l}.type`,value:s.type,onChange:t,onBlur:o,children:Object.values(c.kq).map((e=>(0,v.jsx)(n.ZP.Radio,{value:e,description:a.formatMessage(S[e].description),className:"my-2",style:{minWidth:"1.25rem",minHeight:"1.25rem"},children:a.formatMessage(S[e].label)},e)))})]}),(0,v.jsx)(h.Z,{type:"number",name:`${l}.maxTeamSize`,floatingLabel:a.formatMessage(y.groupFormMaxSizeLabel),value:s.maxTeamSize,help:a.formatMessage(y.groupFormMaxSizeHelp),label:(0,v.jsx)(n.ZP.Label,{className:"h4 pb-4",children:a.formatMessage(y.teamSize)}),className:"mx-2",placeholder:c.dH.DEFAULT})]},"isConfiguring")})},j=u().shape({id:u().string,name:u().string.isRequired,description:u().string.isRequired,type:u().string.isRequired,maxTeamSize:u().number.isRequired});T.propTypes={intl:r.gm.isRequired,fieldNameCommonBase:u().string.isRequired,errors:u().shape({name:u().string,description:u().string,maxTeamSize:u().string}),group:j.isRequired,onDelete:u().func.isRequired,onChange:u().func.isRequired,onBlur:u().func.isRequired},T.defaultProps={errors:{name:null,description:null,maxTeamSize:null}};const R=(0,t.Z)(T);(0,f.fm)();const A=e=>{let{intl:a,onClose:s}=e;const[r,t]=(0,f.Yc)("teamsConfiguration"),d={name:"",description:"",type:c.kq.OPEN,maxTeamSize:null,id:null,key:(0,p.v4)()},u={title:a.formatMessage(y.noGroupsErrorTitle),message:a.formatMessage(y.noGroupsErrorMessage)};return(0,v.jsx)(b.Z,{appId:"teams",title:a.formatMessage(y.heading),enableAppHelp:a.formatMessage(y.enableTeamsHelp),enableAppLabel:a.formatMessage(y.enableTeamsLabel),learnMoreText:a.formatMessage(y.enableTeamsLink),onClose:s,bodyClassName:"bg-light-200",initialValues:{maxTeamSize:r?.maxTeamSize,groups:r?.teamSets||r?.topics},validationSchema:{enabled:m.O7().test("has-groups",u,((e,a)=>!e||a.parent.groups.length>0)),maxTeamSize:m.Rx().required(a.formatMessage(y.maxTeamSizeEmpty)).min(c.dH.MIN,a.formatMessage(y.maxTeamSizeInvalid)).max(c.dH.MAX,a.formatMessage(y.maxTeamSizeTooHigh,{max:c.dH.MAX})),groups:m.IX().of(m.Ry({id:m.Z_().nullable(),name:m.Z_().required(a.formatMessage(y.groupFormNameEmpty)).trim(),type:m.Z_().oneOf(Object.values(c.kq)),description:m.Z_().required(a.formatMessage(y.groupFormDescriptionError)).trim(),maxTeamSize:m.Rx().nullable().min(c.dH.MIN,a.formatMessage(y.maxTeamSizeInvalid)).max(c.dH.MAX,a.formatMessage(y.maxTeamSizeTooHigh,{max:c.dH.MAX})).default(null)})).when("enabled",{is:!0,then:m.IX().min(1)}).default([]).uniqueProperty("name",a.formatMessage(y.groupFormNameExists))},onSettingsSave:async e=>{const a=e.groups?.map((e=>({id:e.id||(0,p.v4)(),name:e.name,type:e.type,description:e.description,max_team_size:e.maxTeamSize})));return t({team_sets:a,max_team_size:e.maxTeamSize,enabled:e.enabled})},configureBeforeEnable:!0,children:e=>{let{handleChange:s,handleBlur:r,values:t,errors:u}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("h4",{className:"my-3 pb-2",children:a.formatMessage(y.teamSize)}),(0,v.jsx)(h.Z,{name:"maxTeamSize",value:t.maxTeamSize,floatingLabel:a.formatMessage(y.maxTeamSize),help:a.formatMessage(y.maxTeamSizeHelp),className:"pb-1",type:"number"}),(0,v.jsxs)("div",{className:"bg-light-200 d-flex flex-column mx-n4 px-4 py-4 border border-top mb-n3.5",children:[(0,v.jsx)("h4",{children:a.formatMessage(y.groups)}),(0,v.jsx)(n.ZP.Text,{className:"mb-3",children:a.formatMessage(y.groupsHelp)}),(0,v.jsx)(l.F2,{name:"groups",children:e=>{let{push:n,remove:l}=e;return(0,v.jsxs)(v.Fragment,{children:[t.groups?.map(((e,a)=>(0,v.jsx)(R,{group:e,errors:u.groups?.[a],fieldNameCommonBase:`groups.${a}`,onDelete:()=>l(a),onChange:s,onBlur:r},e.id||e.key))),(0,v.jsx)(i.ZP,{variant:"plain",className:"p-0 align-self-start mt-3",iconBefore:o.Z,onClick:()=>n(d),children:a.formatMessage(y.addGroup)})]})}})]})]})}})};A.propTypes={intl:r.gm.isRequired,onClose:u().func.isRequired};const z=(0,t.Z)(A)}}]);
//# sourceMappingURL=370.460ce5db6bf286426738.js.map